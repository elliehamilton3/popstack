{"ast":null,"code":"import _extends from \"/Users/ellie/Developer/popstack/packages/ui/node_modules/@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"/Users/ellie/Developer/popstack/packages/ui/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ellie/Developer/popstack/packages/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState, useRef } from \"react\";\nimport { Typography, Grid, TextField, Box, Switch, Chip } from \"@material-ui/core\";\nimport { Skeleton } from \"@material-ui/lab\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport Navbar from \"../components/navbar/navbar.component\";\nimport ParallelogramIcon from \"../components/icons/parallelogram.icon\";\nimport SquareIcon from \"../components/icons/square.icon\";\nimport { getFormValues } from \"../helper/getFormValues\";\nimport ResumeSection from \"../components/resume/resumeSection.component\";\nimport ResumePreview from \"../components/resume/resumePreview.component\";\nimport PersonalDetailsSection from \"../components/resume/personalDetails.component\";\nimport EducationSection from \"../components/resume/educationSection.component\";\nimport EmploymentSection from \"../components/resume/employmentSection.component\";\nimport LinkSection from \"../components/resume/linkSection.component\";\nexport default function Resume() {\n  var _useState = useState(),\n      skills = _useState[0],\n      setSkills = _useState[1];\n\n  var _useState2 = useState(undefined),\n      resume = _useState2[0],\n      setResume = _useState2[1];\n\n  var _useState3 = useState(1),\n      resumeStyle = _useState3[0],\n      setResumeStyle = _useState3[1];\n\n  var _useState4 = useState(false),\n      checked = _useState4[0],\n      setChecked = _useState4[1];\n\n  var formRef = useRef(null);\n\n  var _useAuth = useAuth0(),\n      getAccessTokenSilently = _useAuth.getAccessTokenSilently;\n\n  useEffect(function () {\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var token, response, responseData, _token, response1, responseData1, skillNames, _skillNames;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return getAccessTokenSilently();\n\n            case 3:\n              token = _context.sent;\n              _context.next = 6;\n              return fetch(\"http://localhost:3001/v1/resume/0\", {\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n\n            case 6:\n              response = _context.sent;\n              _context.next = 9;\n              return response.json();\n\n            case 9:\n              responseData = _context.sent;\n\n              if (!(responseData.statusCode === 404)) {\n                _context.next = 25;\n                break;\n              }\n\n              _context.next = 13;\n              return getAccessTokenSilently();\n\n            case 13:\n              _token = _context.sent;\n              _context.next = 16;\n              return fetch(\"http://localhost:3001/v1/resume\", {\n                method: \"POST\",\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(_token)\n                }\n              });\n\n            case 16:\n              response1 = _context.sent;\n              _context.next = 19;\n              return response1.json();\n\n            case 19:\n              responseData1 = _context.sent;\n              setResume(responseData1);\n              skillNames = responseData.skills.map(function (_ref2) {\n                var name = _ref2.name;\n                console.log(name);\n                return name;\n              });\n              setSkills(skillNames);\n              _context.next = 28;\n              break;\n\n            case 25:\n              setResume(responseData);\n              _skillNames = responseData.skills.map(function (_ref3) {\n                var name = _ref3.name;\n                console.log(name);\n                return name;\n              });\n              setSkills(_skillNames);\n\n            case 28:\n              _context.next = 33;\n              break;\n\n            case 30:\n              _context.prev = 30;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0.message);\n\n            case 33:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 30]]);\n    }))();\n  }, [getAccessTokenSilently]);\n\n  var updateResume = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var form, formData, token, response, responseData, skillNames;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              form = formRef.current;\n              formData = getFormValues(form);\n              console.log(skills);\n              formData.skills = skills;\n              _context2.prev = 4;\n              _context2.next = 7;\n              return getAccessTokenSilently();\n\n            case 7:\n              token = _context2.sent;\n              _context2.next = 10;\n              return fetch(\"http://localhost:3001/v1/resume/0\", {\n                method: \"PATCH\",\n                body: JSON.stringify(formData),\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n\n            case 10:\n              response = _context2.sent;\n              _context2.next = 13;\n              return response.json();\n\n            case 13:\n              responseData = _context2.sent;\n              setResume(responseData);\n              skillNames = responseData.skills.map(function (_ref5) {\n                var name = _ref5.name;\n                console.log(name);\n                return name;\n              });\n              setSkills(skillNames);\n              _context2.next = 22;\n              break;\n\n            case 19:\n              _context2.prev = 19;\n              _context2.t0 = _context2[\"catch\"](4);\n              console.log(_context2.t0.message);\n\n            case 22:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[4, 19]]);\n    }));\n\n    return function updateResume() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handleChange = function handleChange() {\n    setChecked(!checked);\n    setResumeStyle(!checked ? 2 : 1);\n  };\n\n  var skillsList = [{\n    title: 'React'\n  }, {\n    title: 'Javascript'\n  }, {\n    title: 'Java'\n  }, {\n    title: 'Front-end'\n  }, {\n    title: 'Back-end'\n  }, {\n    title: 'UI Design'\n  }, {\n    title: 'UX Research'\n  }, {\n    title: 'Copywriting'\n  }, {\n    title: 'Illustrating'\n  }, {\n    title: 'Figma'\n  }];\n  return __jsx(React.Fragment, null, __jsx(Navbar, null), __jsx(Grid, {\n    container: true\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    sm: 12,\n    md: 6\n  }, __jsx(ResumePreview, {\n    resume: resume,\n    resumeStyle: resumeStyle\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    sm: 12,\n    md: 6\n  }, __jsx(Box, {\n    p: 3,\n    pt: 12\n  }, __jsx(Grid, {\n    container: true,\n    direction: \"column\"\n  }, __jsx(\"form\", {\n    ref: formRef,\n    noValidate: true,\n    autoComplete: \"off\"\n  }, __jsx(Box, {\n    pb: 4\n  }, __jsx(Grid, {\n    item: true\n  }, __jsx(Grid, {\n    container: true,\n    justify: \"space-between\",\n    alignItems: \"center\"\n  }, __jsx(Grid, {\n    item: true\n  }, !resume ? __jsx(Skeleton, {\n    variant: \"text\",\n    width: 140,\n    height: 26\n  }) : __jsx(Typography, {\n    variant: \"h2\"\n  }, \"Your R\\xE9sum\\xE9\")), __jsx(Grid, {\n    item: true\n  }, __jsx(Switch, {\n    checked: checked,\n    onChange: handleChange,\n    name: \"checkedA\",\n    inputProps: {\n      'aria-label': 'secondary checkbox'\n    }\n  }))))), __jsx(PersonalDetailsSection, {\n    loading: !resume,\n    onChange: updateResume,\n    firstName: resume && resume.user && resume.user.firstName,\n    lastName: resume && resume.user && resume.user.lastName,\n    phoneNumber: resume && resume.user && resume.user.phoneNumber,\n    email: resume && resume.user && resume.user.email,\n    title: resume && resume.resume && resume.resume.title\n  }), __jsx(ResumeSection, {\n    loading: !resume,\n    icon: __jsx(ParallelogramIcon, {\n      fontSize: \"large\"\n    }),\n    heading: \"Describe you and your work\",\n    subtitle: \"Summarise your professional career in 2 or 3 sentences.\"\n  }, !resume ? __jsx(Skeleton, {\n    variant: \"rect\",\n    width: \"100%\",\n    height: 114\n  }) : __jsx(TextField, {\n    name: \"bio\",\n    fullWidth: true,\n    id: \"filled-textarea\",\n    multiline: true,\n    variant: \"filled\",\n    rows: 4,\n    defaultValue: resume && resume.resume && resume.resume.bio,\n    onChange: function onChange() {\n      return updateResume();\n    }\n  })), resume && __jsx(EmploymentSection, {\n    employment: resume === null || resume === void 0 ? void 0 : resume.jobs,\n    onChange: updateResume\n  }), resume && __jsx(EducationSection, {\n    educations: resume === null || resume === void 0 ? void 0 : resume.educations,\n    onChange: updateResume\n  }), resume && skills && __jsx(ResumeSection, {\n    icon: __jsx(SquareIcon, {\n      fontSize: \"large\"\n    }),\n    heading: \"Skills\",\n    subtitle: \"Add keywords to your resume to help potential employers get a clearer picture of what your skills are in the workplace.\"\n  }, __jsx(Autocomplete, {\n    multiple: true,\n    id: \"skills\",\n    options: skillsList.map(function (option) {\n      return option.title;\n    }),\n    freeSolo: true,\n    renderTags: function renderTags(value, getTagProps) {\n      return value.map(function (option, index) {\n        return __jsx(Chip, _extends({\n          color: \"primary\",\n          label: option\n        }, getTagProps({\n          index: index\n        })));\n      });\n    } // defaultValue={[...skills]}\n    ,\n    onChange: function onChange(event, value) {\n      console.log(value);\n      setSkills(value);\n      updateResume();\n    },\n    renderInput: function renderInput(params) {\n      return __jsx(TextField, _extends({}, params, {\n        variant: \"filled\",\n        placeholder: \"Add skills\",\n        fullWidth: true\n      }));\n    }\n  })), resume && __jsx(LinkSection, {\n    links: resume === null || resume === void 0 ? void 0 : resume.links,\n    onChange: updateResume\n  })))))));\n}","map":null,"metadata":{},"sourceType":"module"}