{"ast":null,"code":"import _regeneratorRuntime from \"/Users/ellie/Developer/popstack/packages/ui/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/ellie/Developer/popstack/packages/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState, useRef } from \"react\";\nimport { Button, Typography, Grid, TextField, Box, makeStyles, lighten, Switch } from \"@material-ui/core\";\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport Navbar from \"../components/navbar/navbar.component\"; // import apiFetch from \"../../service/apiFetch.service\";\n\nimport AddIcon from \"@material-ui/icons/Add\";\nimport ParallelogramIcon from \"../components/icons/parallelogram.icon\";\nimport SquareIcon from \"../components/icons/square.icon\";\nimport RectangleIcon from \"../components/icons/rectangle.icon\";\nimport { getFormValues } from \"../helper/getFormValues\";\nimport ResumeSection from \"../components/resume/resumeSection.component\";\nimport ResumePreview from \"../components/resume/resumePreview.component\";\nimport PersonalDetailsSection from \"../components/resume/personalDetails.component\";\nimport EducationSection from \"../components/resume/educationSection.component\";\nimport EmploymentSection from \"../components/resume/employmentSection.component\";\nvar useStyles = makeStyles(function (theme) {\n  return {\n    button: {\n      justifyContent: \"space-between\",\n      color: lighten(theme.palette.common.black, 0.4),\n      padding: \"10px 16px\"\n    },\n    icon: {\n      color: lighten(theme.palette.primary.light, 0.7)\n    }\n  };\n});\nexport default function Resume() {\n  var _useState = useState(undefined),\n      resume = _useState[0],\n      setResume = _useState[1];\n\n  var _useState2 = useState(1),\n      resumeStyle = _useState2[0],\n      setResumeStyle = _useState2[1];\n\n  var _useState3 = useState(false),\n      checked = _useState3[0],\n      setChecked = _useState3[1];\n\n  var classes = useStyles();\n  var formRef = useRef(null);\n\n  var _useAuth = useAuth0(),\n      getAccessTokenSilently = _useAuth.getAccessTokenSilently;\n\n  useEffect(function () {\n    _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var token, response, responseData, _token, response1, responseData1;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return getAccessTokenSilently();\n\n            case 3:\n              token = _context.sent;\n              _context.next = 6;\n              return fetch(\"http://localhost:3000/v1/resume/0\", {\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n\n            case 6:\n              response = _context.sent;\n              _context.next = 9;\n              return response.json();\n\n            case 9:\n              responseData = _context.sent;\n\n              if (!(responseData.statusCode === 404)) {\n                _context.next = 23;\n                break;\n              }\n\n              _context.next = 13;\n              return getAccessTokenSilently();\n\n            case 13:\n              _token = _context.sent;\n              _context.next = 16;\n              return fetch(\"http://localhost:3000/v1/resume\", {\n                method: \"POST\",\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(_token)\n                }\n              });\n\n            case 16:\n              response1 = _context.sent;\n              _context.next = 19;\n              return response1.json();\n\n            case 19:\n              responseData1 = _context.sent;\n              setResume(responseData1);\n              _context.next = 24;\n              break;\n\n            case 23:\n              setResume(responseData);\n\n            case 24:\n              _context.next = 29;\n              break;\n\n            case 26:\n              _context.prev = 26;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0.message);\n\n            case 29:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 26]]);\n    }))();\n  }, [getAccessTokenSilently]);\n\n  var updateResume = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var form, formData, token, response, responseData;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              form = formRef.current;\n              formData = getFormValues(form);\n              _context2.prev = 2;\n              _context2.next = 5;\n              return getAccessTokenSilently();\n\n            case 5:\n              token = _context2.sent;\n              _context2.next = 8;\n              return fetch(\"http://localhost:3000/v1/resume/0\", {\n                method: \"PATCH\",\n                body: JSON.stringify(formData),\n                headers: {\n                  Accept: \"application/json\",\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \".concat(token)\n                }\n              });\n\n            case 8:\n              response = _context2.sent;\n              _context2.next = 11;\n              return response.json();\n\n            case 11:\n              responseData = _context2.sent;\n              setResume(responseData);\n              _context2.next = 18;\n              break;\n\n            case 15:\n              _context2.prev = 15;\n              _context2.t0 = _context2[\"catch\"](2);\n              console.log(_context2.t0.message);\n\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[2, 15]]);\n    }));\n\n    return function updateResume() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleChange = function handleChange() {\n    setChecked(!checked);\n    setResumeStyle(!checked ? 2 : 1);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Navbar, null), __jsx(Grid, {\n    container: true\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    sm: 12,\n    md: 6\n  }, __jsx(ResumePreview, {\n    resume: resume,\n    resumeStyle: resumeStyle\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    sm: 12,\n    md: 6\n  }, __jsx(Box, {\n    p: 3,\n    pt: 12\n  }, __jsx(Grid, {\n    container: true,\n    direction: \"column\"\n  }, __jsx(\"form\", {\n    ref: formRef,\n    noValidate: true,\n    autoComplete: \"off\"\n  }, __jsx(Box, {\n    pb: 4\n  }, __jsx(Grid, {\n    item: true\n  }, __jsx(Grid, {\n    container: true,\n    justify: \"space-between\",\n    alignItems: \"center\"\n  }, __jsx(Grid, {\n    item: true\n  }, __jsx(Typography, {\n    variant: \"h2\"\n  }, \"Your Resum\\xE9\")), __jsx(Grid, {\n    item: true\n  }, __jsx(Switch, {\n    checked: checked,\n    onChange: handleChange,\n    name: \"checkedA\",\n    inputProps: {\n      'aria-label': 'secondary checkbox'\n    }\n  }))))), resume && __jsx(PersonalDetailsSection, {\n    onChange: updateResume,\n    firstName: resume && resume.user && resume.user.firstName,\n    lastName: resume && resume.user && resume.user.lastName,\n    phoneNumber: resume && resume.user && resume.user.phoneNumber,\n    email: resume && resume.user && resume.user.email,\n    title: resume && resume.resume && resume.resume.title\n  }), __jsx(ResumeSection, {\n    icon: __jsx(ParallelogramIcon, {\n      fontSize: \"large\"\n    }),\n    heading: \"Describe you and your work\",\n    subtitle: \"Summarise your professional career in 2 or 3 sentences.\"\n  }, __jsx(TextField, {\n    name: \"bio\",\n    fullWidth: true,\n    id: \"filled-textarea\",\n    multiline: true,\n    variant: \"filled\",\n    rows: 4,\n    defaultValue: resume && resume.resume && resume.resume.bio,\n    onChange: function onChange() {\n      return updateResume();\n    }\n  })), __jsx(EmploymentSection, {\n    employment: resume === null || resume === void 0 ? void 0 : resume.jobs,\n    onChange: updateResume\n  }), __jsx(EducationSection, {\n    educations: resume === null || resume === void 0 ? void 0 : resume.educations,\n    onChange: updateResume\n  }), __jsx(ResumeSection, {\n    icon: __jsx(RectangleIcon, {\n      fontSize: \"large\"\n    }),\n    heading: \"Websites & social media links\",\n    subtitle: \"Include a link to your personal website or portfolio, Github repository, LinkedIn, or anything you might want potential employers to see.\"\n  }, __jsx(Button, {\n    color: \"secondary\",\n    variant: \"outlined\",\n    className: classes.button,\n    fullWidth: true,\n    endIcon: __jsx(AddIcon, {\n      className: classes.icon\n    })\n  }, \"Add website or link\")), __jsx(ResumeSection, {\n    icon: __jsx(SquareIcon, {\n      fontSize: \"large\"\n    }),\n    heading: \"Skills\",\n    subtitle: \"Add any skills you have that you want to highlight.\"\n  }, __jsx(Button, {\n    color: \"secondary\",\n    variant: \"outlined\",\n    className: classes.button,\n    fullWidth: true,\n    endIcon: __jsx(AddIcon, {\n      className: classes.icon\n    })\n  }, \"Add a skill\"))))))));\n}","map":null,"metadata":{},"sourceType":"module"}